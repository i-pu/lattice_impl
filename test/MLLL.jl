@testset "MLLL" begin
    b = [
        388 417 417 -86
        -672 -73 -121 944
        -689 379 724 653
        -179 96 -24 978
        508 -705 173 -343
    ]
    δ = 0.75
    b_true = [
        1 0 1 0
        -1 1 1 3
        -2 -4 1 0
        3 -1 -3 2
        0 0 0 0
    ]
    mlll_reduced!(b, δ)

    @test b ==  b_true
end

@testset "q-ary MLLL" begin
    A = [
        1 5 21 3 14
        17 0 12 12 13
        12 21 15 6 6
        4 13 24 7 16
        20 9 22 27 8 
        19 8 19 3 1
        18 22 4 8 18
        6 28 9 5 18
        10 11 19 18 21
        28 18 24 27 20
    ]
    B_true = [
        -2 0 -1 1 -4 1 -2 1 -1 0
        2 -4 0 0 1 1 0 -4 1 1
        3 -2 1 -1 1 0 0 3 3 -1
        -2 2 -3 2 0 3 0 0 -1 1
        2 4 -2 0 -3 0 0 0 0 -1
        -1 2 3 0 1 2 3 1 -2 0
        -1 -3 -1 -1 -2 -1 -1 3 0 4
        0 2 2 4 -2 -3 0 1 -2 3
        2 -1 -1 2 -1 1 1 5 -5 0
        -1 2 1 -2 3 3 -6 -3 0 1
    ]
    @assert size(B_true) == (10, 10)
    q, δ = 29, 0.99
    m, n = size(A)
    b = [
        A'
        q * Matrix{Int64}(I, m, m)
    ]

    mlll_reduced!(b, δ)
    @test b[1:m, :] == B_true
end